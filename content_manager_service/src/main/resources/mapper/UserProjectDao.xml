<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.content_manager_service.dao.UserProjectDao" >

    <insert id="createUserProject" parameterType="com.model.UserProjectVO">
        INSERT INTO user_project
        (user_id, project_id)
        VALUES
        <foreach collection="projects" item="projectId" index="index" open="(" separator="),("  close=")">
            #{userId}, #{projectId}
        </foreach>

    </insert>

    <resultMap id="projectResult" type="com.model.ProjectVO">
        <collection property="assigned_users" ofType="Map" select="getUsersAssignedToProject" column="project_id" />
    </resultMap>

    <select id="getAllProjects" resultMap="projectResult" resultType="com.model.ProjectVO">
        SELECT * FROM project
    </select>

    <select id="getUsersAssignedToProject" resultType="Map">
        SELECT Q.project_id,Q.user_id,A.user_id,A.first_name,A.last_name,A.email.A.profile_picture_path,A.user_level FROM user_project Q
        INNER JOIN
        app_user U
        ON
        U.user_id = Q.user_id
        WHERE Q.project_id = #{projectId}
    </select>

    <!--<update id="updateProject" parameterType="com.model.ProjectVO">
        UPDATE project
        SET
        status = #{status},
        client_email = #{clientEmail},
        client_name = #{clientName},
        phone_number = #{phoneNumber},
        jira_id = #{jiraId},
        project_description = #{projectDescription},
        project_name = #{projectName}
        WHERE
        project_id = #{projectId}
        AND
        admin_id = #{adminId}
    </update>

    <delete id="deleteProject" parameterType="Long">
        DELETE FROM project WHERE project_id = #{projectId}
    </delete>-->




</mapper>